{% set listen_params_v %}{% block listen_params %}{% endblock %}{% endset %}
server {
    listen {{ port }} {{ listen_params_v }};
    listen [::]:{{ port }} {{ listen_params_v }};
    server_name {{ nginx_vhost.server_name }};

{% block options %}{% endblock %}

# SSL certificates
{% block sslcertificates %}{% endblock %}

# Locations
{% block location %}{% endblock %}
    location / {
{% block main_location %}{% endblock %}
        # Authentication
{% block authentication %}{% if nginx_auth_basic is defined and nginx_auth_basic | length > 0 %}
        auth_basic           "{{ nginx_basicauth_title }}";
        auth_basic_user_file "{{ nginx_htpasswd_path }}/.{{ project_name }}";
{% endif %}{% endblock %}
    }
}